(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M;a=self;b=a.WebSharper;c=b&&b.Obj;d=b.Forms=b.Forms||{};e=d.ErrorMessage=d.ErrorMessage||{};f=d.Fresh=d.Fresh||{};g=d.Result=d.Result||{};h=d.Form=d.Form||{};i=d.Utils=d.Utils||{};j=h.Dependent=h.Dependent||{};k=h.Many=h.Many||{};l=k.ItemOperations=k.ItemOperations||{};m=k.Fresh=k.Fresh||{};n=k.Collection=k.Collection||{};o=k.CollectionWithDefault=k.CollectionWithDefault||{};p=h.Builder=h.Builder||{};q=d.Validation=d.Validation||{};r=d.Pervasives=d.Pervasives||{};s=d.Attr=d.Attr||{};t=d.Doc=d.Doc||{};u=d.View=d.View||{};v=a.StartupCode$WebSharper_Forms$Forms=a.StartupCode$WebSharper_Forms$Forms||{};w=a.IntelliFactory;x=w&&w.Runtime;y=b&&b.List;z=b&&b.Collections;A=z&&z.Dictionary;B=b&&b.UI;C=B&&B.Doc;D=B&&B.View;E=B&&B.Var$1;F=b&&b.Seq;G=B&&B.Submitter;H=b&&b.Arrays;I=B&&B.Array;J=b&&b.Concurrency;K=b&&b.Unchecked;L=B&&B.AttrProxy;M=B&&B.AttrModule;e=d.ErrorMessage=x.Class({},c,e);e.Create=function(N,O){return new e.New(N.id,O);};e.Create$1=function(N,O){return new e.New(N,O);};e.New=x.Ctor(function(N,O){c.New.call(this);this.id=N;this.message=O;},e);f.Id=function(){(f.lastId())[0]++;return"Form"+a.String((f.lastId())[0]);};f.lastId=function(){v.$cctor();return v.lastId;};g.FailWith=function(N,O){return{$:1,$0:y.ofArray([new e.New(O==null?f.Id():O.$0,N)])};};g.Append=function(N,O,P){return O.$==0?P.$==0?{$:0,$0:N(O.$0,P.$0)}:P:P.$==0?O:{$:1,$0:y.append(O.$0,P.$0)};};g.Bind=function(N,O){return O.$==0?N(O.$0):{$:1,$0:O.$0};};g.ApJoin=function(N,O){var P;return N.$==0?(O.$==0?O.$0.$==0?(P=O.$0.$0,false):(P=O.$0.$0,true):(P=O.$0,true))?{$:1,$0:P}:{$:0,$0:N.$0(P)}:O.$==0?{$:1,$0:N.$0}:{$:1,$0:y.append(N.$0,O.$0)};};g.Apply=function(N,O){return N.$==0?O.$==0?{$:0,$0:N.$0(O.$0)}:{$:1,$0:O.$0}:O.$==0?{$:1,$0:N.$0}:{$:1,$0:y.append(N.$0,O.$0)};};g.Map=function(N,O){return O.$==1?{$:1,$0:O.$0}:{$:0,$0:N(O.$0)};};g.IsFailure=function(N){return N.$==1;};g.IsSuccess=function(N){return N.$!=1;};h.New=function(N,O,P){return{id:N,view:O,render:P};};i.memoize=function(N){var O;O=new A.New$5();return function(P){var Q;return O.ContainsKey(P)?O.get_Item(P):(Q=N(P),(O.set_Item(P,Q),Q));};};j=h.Dependent=x.Class({RenderDependent:function(N){return C.BindView(function(O){return O.$==1?C.get_Empty():O.$0.render(N);},this.pOut);}},c,j);j.New=x.Ctor(function(N,O){c.New.call(this);this.renderPrimary=N;this.pOut=O;this.out=D.Bind(function(P){return P.$==1?D.Const({$:1,$0:P.$0}):P.$0.view;},this.pOut);},j);j.Make=function(N,O){var P;return new j.New(N.render,D.Map((P=i.memoize(function(Q){var R;R=O(Q);return h.New(R.id,R.view,R.render);}),function(Q){return g.Map(P,Q);}),N.view));};l=k.ItemOperations=x.Class({},c,l);l.New=x.Ctor(function(N,O,P){c.New.call(this);this["delete"]=N;this.moveUp=O;this.moveDown=P;},l);m.Int=function(){v.$cctor();return v.Int;};n=k.Collection=x.Class({adderView:function(N){N.$==0?this.add(N.$0):void 0;return C.get_Empty();},add:function(N){this.arr.push(this.mk(N));E.Update(this["var"],a.id);},fst3:a.id,mk:function(N){var O,P,Q,R,S,T,U,V,W;function X(Y,Z,_0){return P===_0;}O=this;P=(m.Int())();Q=function(Y){return F.findIndex(function(Z){return X(Z[0],Z[1],Z[2]);},Y);};R=D.Map(Q,this["var"].get_View());S=new G.New(D.Map(function(Y){return Y===0?{$:1,$0:y.T.Empty}:{$:0,$0:true};},R),H.length(this.arr)===0?{$:1,$0:y.T.Empty}:{$:0,$0:false});T=D.Map(function(Y){var Z;if(Y.$==0)if(Y.$0){Z=Q(O.arr);k["List`1.Swap"](O.arr,Z,Z-1);E.Update(O["var"],a.id);}},S.view);U=new G.New(D.Map(function(Y){return Y===H.length(O.arr)-1?{$:1,$0:y.T.Empty}:{$:0,$0:true};},R),{$:1,$0:y.T.Empty});V=D.Map(function(Y){var Z;if(Y.$==0)if(Y.$0){Z=Q(O.arr);k["List`1.Swap"](O.arr,Z,Z+1);E.Update(O["var"],a.id);}},U.view);W=this.p(N);return[h.New(W.id,D.Map2(a.id,W.view,D.Map2(function(){return null;},T,V)),W.render),new l.New(function(){var Y,Z;Y=O.arr;Z=Q(O.arr);Y.splice.apply(Y,[Z,1]);E.Update(O["var"],a.id);},S,U),P];},RenderAdder:function(N){var O,P;O=this;P=this.adder.render(N);return C.Append(C.EmbedView(D.Map(function(Q){return O.adderView(Q);},this.adder.view)),P);},Render:function(N){function O(Q,R,S){return S;}function P(Q,R,S){return Q.render(N(R));}return C.ConvertBy(function(Q){return O(Q[0],Q[1],Q[2]);},function(Q){return P(Q[0],Q[1],Q[2]);},this.changesView);}},c,n);n.New=x.Ctor(function(N,O,P){var Q,R,S;function T(U){return Q.mk(U);}Q=this;c.New.call(this);this.p=N;this.adder=P;this.arr=[];this["var"]=E.Create$1(this.arr);F.iter((R=(S=this.arr,function(U){S.push(U);}),function(U){return R(T(U));}),O);this.changesView=D.Bind(function(U){var V;V=U.slice();return I.MapTreeReduce(function(W){return D.Map(function(){return[W];},Q.fst3(W[0],W[1],W[2]).view);},D.Const([]),function(W,X){return D.Map2(F.append,W,X);},V);},this["var"].get_View());this.out=D.Bind(function(U){var V,W,X;function Y(_0,_1,_2){function _3(_4){return[_4];}return D.Map(function(_4){return g.Map(_3,_4);},_0.view);}function Z(_0,_1){return g.Append(F.append,_0,_1);}V=U.slice();W=D.Const({$:0,$0:[]});X=(x.Curried3(D.Map2))(Z);return I.MapTreeReduce(function(_0){return Y(_0[0],_0[1],_0[2]);},W,function(_0,_1){return(X(_0))(_1);},V);},this["var"].get_View());},n);o=k.CollectionWithDefault=x.Class({AddOne:function(){this.add(this["default"]);}},n,o);o.New=x.Ctor(function(N,O,P,Q){n.New.call(this,N,O,P);this["default"]=Q;},o);k["List`1.Swap"]=function(N,O,P){var Q;Q=H.get(N,O);H.set(N,O,H.get(N,P));H.set(N,P,Q);};p.Do={$:0};h.Dependent$1=function(N,O){var P;P=j.Make(N,O);return h.New(f.Id(),P.out,function(Q){return Q(P);});};h.Many$1=function(N,O,P){var Q;Q=new o.New(P,N,P(O),O);return h.New(f.Id(),Q.out,function(R){return R(Q);});};h.ManyForm=function(N,O,P){var Q;Q=new n.New(P,N,O);return h.New(f.Id(),Q.out,function(R){return R(Q);});};h.RunResult=function(N,O){return h.MapResult(function(P){N(P);return P;},O);};h.Run=function(N,O){return h.Map(function(P){N(P);return P;},O);};h.FlushErrors=function(N){return h.MapResult(function(O){return O.$==1?{$:1,$0:y.T.Empty}:O;},N);};h.MapRenderArgs=function(N,O){return h.New(O.id,O.view,function(P){return P(O.render(N));});};h.MapAsync=function(N,O){return h.MapAsyncResult(function(P){var Q,R,S,T;return P.$==1?(Q=P.$0,(R=null,J.Delay(function(){return J.Return({$:1,$0:Q});}))):(S=P.$0,(T=null,J.Delay(function(){return J.Bind(N(S),function(U){return J.Return({$:0,$0:U});});})));},O);};h.MapToAsyncResult=function(N,O){return h.MapAsyncResult(function(P){var Q,R,S,T;return P.$==1?(Q=P.$0,(R=null,J.Delay(function(){return J.Return({$:1,$0:Q});}))):(S=P.$0,(T=null,J.Delay(function(){return N(S);})));},O);};h.MapAsyncResult=function(N,O){return h.New(O.id,D.MapAsync(N,O.view),O.render);};h.Map=function(N,O){return h.MapResult(function(P){return g.Map(N,P);},O);};h.MapToResult=function(N,O){return h.MapResult(function(P){return g.Bind(N,P);},O);};h.MapResult=function(N,O){return h.New(O.id,D.Map(N,O.view),O.render);};h.TransmitViewMap=function(N,O){return h.TransmitViewMapResult(function(P){return g.Map(N,P);},O);};h.TransmitViewMapResult=function(N,O){return h.New(O.id,O.view,function(P){return(O.render(P))(D.Map(N,O.view));});};h.TransmitView=function(N){return h.New(N.id,N.view,function(O){return(N.render(O))(N.view);});};h.WithSubmit=function(N){var O;O=new G.New(N.view,{$:1,$0:y.T.Empty});return h.New(f.Id(),O.view,function(P){return(N.render(P))(O);});};h.ApJoin=function(N,O){var P,Q;return h.New(f.Id(),D.Map2(g.ApJoin,N.view,O.view),(P=N.render,(Q=O.render,function(R){return Q(P(R));})));};h.Apply=function(N,O){var P,Q;return h.New(f.Id(),D.Map2(g.Apply,N.view,O.view),(P=N.render,(Q=O.render,function(R){return Q(P(R));})));};h.YieldOption=function(N,O){var P;P=E.Create$1(N==null?O:N.$0);return h.New(P.get_Id(),D.Map(function(Q){return{$:0,$0:K.Equals(Q,O)?null:{$:1,$0:Q}};},P.get_View()),function(Q){return Q(P);});};h.YieldFailure=function(){var N,O;N=E.Create$1(void 0);O=N.get_View();return h.New(N.get_Id(),D.SnapshotOn({$:1,$0:y.T.Empty},O,D.Map(function(P){return{$:0,$0:P};},O)),function(P){return P(N);});};h.Yield=function(N){return h.YieldVar(E.Create$1(N));};h.YieldVar=function(N){return h.New(N.get_Id(),D.Map(function(O){return{$:0,$0:O};},N.get_View()),function(O){return O(N);});};h.ReturnFailure=function(){return h.New(f.Id(),D.Const({$:1,$0:y.T.Empty}),a.id);};h.Return=function(N){return h.New(f.Id(),D.Const({$:0,$0:N}),a.id);};h.Render=function(N,O){var P;P=O.render(N);return C.Append(C.EmbedView(D.Map(function(){return C.get_Empty();},O.view)),P);};h.Create=function(N,O){return h.New(f.Id(),N,O);};q.MapValidCheckedInput=function(N,O){return h.MapResult(function(P){return P.$==1?{$:1,$0:P.$0}:P.$0.$==0?{$:0,$0:P.$0.$0}:{$:1,$0:y.ofArray([e.Create(O,N)])};},O);};q.IsMatch=function(N,O,P){var Q;return q.Is((Q=new a.RegExp(N),function(R){return Q.test(R);}),O,P);};q.IsNotEmpty=function(N,O){return q.Is(function(P){return P!=="";},N,O);};q.Is=function(N,O,P){return h.MapResult(function(Q){return Q.$==1?Q:N(Q.$0)?Q:{$:1,$0:y.ofArray([new e.New(P.id,O)])};},P);};r.op_LessMultiplyQmarkGreater=function(N,O){return h.ApJoin(N,O);};r.op_LessMultiplyGreater=function(N,O){return h.Apply(N,O);};s.SubmitterValidate=function(N){var O;return L.Append(M.Handler("click",function(){return function(){return N.Trigger();};}),(O=D.Const("disabled"),M.DynamicPred("disabled",D.Map(g.IsFailure,N.input),O)));};t.ShowSuccess=function(N,O){return C.BindView(function(P){return P.$==1?C.get_Empty():O(P.$0);},N);};t.ShowErrors=function(N,O){return C.BindView(function(P){return P.$==1?O(P.$0):C.get_Empty();},N);};t.ButtonValidate=function(N,O,P){return C.Element("button",F.append([s.SubmitterValidate(P)],O),[C.TextNode(N)]);};u.Through=function(N,O){return D.Map(function(P){return P.$==1?{$:1,$0:y.filter(function(Q){return Q.id===O.id;},P.$0)}:P;},N);};u.Through$1=function(N,O){return D.Map(function(P){return P.$==1?{$:1,$0:y.filter(function(Q){return Q.id===O.get_Id();},P.$0)}:P;},N);};v.$cctor=function(){var N;v.$cctor=a.ignore;v.lastId=[0];v.Int=(N=[0],function(){N[0]++;return N[0];});};}());
